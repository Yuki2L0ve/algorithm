# P3389 高斯消元法
[传送门](https://www.luogu.com.cn/problem/P3389)
```C++
#include <bits/stdc++.h>
using namespace std;
const int N = 110;
const double eps = 1e-7;
double g[N][N];
int n;

int Gauss() {
    for (int i = 1; i <= n; ++ i) {
        // 本题一旦没有唯一解，直接打印"No Solution"，于是可以这么写
        int row = i;
        for (int r = i + 1; r <= n; ++ r)
            if (fabs(g[r][i]) > fabs(g[row][i]))
                row = r;

        swap(g[i], g[row]);

        if (fabs(g[i][i]) < eps)    return 0;

        double tmp = g[i][i];
        for (int j = i; j <= n + 1; ++ j) {
            g[i][j] /= tmp;
        }
        for (int r = 1; r <= n; ++ r) {
            if (i != r) {
                double rate = g[r][i] / g[i][i];
                for (int k = i; k <= n + 1; ++ k)
                    g[r][k] -= g[i][k] * rate;
            }
        }
    }
    return 1;
}

int main() {
    scanf("%d", &n);
    for (int i = 1; i <= n; ++ i)
        for (int j = 1; j <= n + 1; ++ j)
            scanf("%lf", &g[i][j]);

    int t = Gauss();

    if (t == 0) {
        puts("No Solution");
    } else {
        for (int i = 1; i <= n; ++ i)
            printf("%.2lf\n", g[i][n + 1]);
    }
}
```

# P2455 线性方程组
[传送门](https://www.luogu.com.cn/problem/P2455)
```C++
#include <bits/stdc++.h>
using namespace std;
const int N = 55;
const double eps = 1e-7;
double g[N][N];
int n;

void Gauss() {
    for (int i = 1; i <= n; ++ i) {
        int row = i;
        for (int r = 1; r <= n; ++ r) {
            if (r < i && fabs(g[r][r]) >= eps) {
                continue;
            }
            if (fabs(g[r][i]) > fabs(g[row][i])) {
                row = r;
            }
        }

        swap(g[i], g[row]);

        if (fabs(g[i][i]) >= eps) {
            double tmp = g[i][i];
            for (int j = i; j <= n + 1; ++ j)
                g[i][j] /= tmp;
            for (int r = 1; r <= n; ++ r) {
                if (r != i) {
                    double rate = g[r][i] / g[i][i];
                    for (int k = i; k <= n + 1; ++ k)
                        g[r][k] -= g[i][k] * rate;
                }
            }
        }
    }
}

int main() {
    scanf("%d", &n);
    for (int i = 1; i <= n; ++ i)
        for (int j = 1; j <= n + 1; ++ j)
            scanf("%lf", &g[i][j]);

    Gauss();

    int sign = 1;
    for (int i = 1; i <= n; ++ i) {
        // 无解
        if (fabs(g[i][i]) < eps && fabs(g[i][n + 1]) >= eps) {
            sign = -1;
            break;
        }
        // 无数解
        if (fabs(g[i][i]) < eps) {
            sign = 0;
        }
    }

    if (sign == 1) {
        for (int i = 1; i <= n; ++ i)
            printf("x%d=%.2lf\n", i, g[i][n + 1]);
    } else {
        printf("%d\n", sign);
    }
}
```

# AcWing883. 高斯消元解线性方程组
[传送门](https://www.acwing.com/problem/content/885/)
```C++
#include <bits/stdc++.h>
using namespace std;
const int N = 110;
const double eps = 1e-7;
double g[N][N];
int n;

void Gauss() {
    for (int i = 1; i <= n; ++ i) {
        int row = i;
        for (int r = 1; r <= n; ++ r) {
            if (r < i && fabs(g[r][r]) >= eps) {
                continue;
            }
            if (fabs(g[r][i]) > fabs(g[row][i])) {
                row = r;
            }
        }

        swap(g[i], g[row]);

        if (fabs(g[i][i]) >= eps) {
            double tmp = g[i][i];
            for (int j = i; j <= n + 1; ++ j)
                g[i][j] /= tmp;
            for (int r = 1; r <= n; ++ r) {
                if (r != i) {
                    double rate = g[r][i] / g[i][i];
                    for (int k = i; k <= n + 1; ++ k)
                        g[r][k] -= g[i][k] * rate;
                }
            }
        }
    }
}

int main() {
    scanf("%d", &n);
    for (int i = 1; i <= n; ++ i)
        for (int j = 1; j <= n + 1; ++ j)
            scanf("%lf", &g[i][j]);

    Gauss();

    int sign = 1;
    for (int i = 1; i <= n; ++ i) {
        if (fabs(g[i][i]) < eps && fabs(g[i][n + 1]) >= eps) {
            sign = -1;
            break;
        }
        if (fabs(g[i][i]) < eps) {
            sign = 0;
        }
    }

    if (sign == -1) {   // 无解
        puts("No solution");
    } else if (sign == 0) { // 无穷解
        puts("Infinite group solutions");
    } else {    // 唯一解
        for (int i = 1; i <= n; ++ i) {
            printf("%.2lf\n", g[i][n + 1]);
        }
    }
}
```

# P4035 球形空间产生器
[传送门](https://www.luogu.com.cn/problem/P4035)
```C++
#include <bits/stdc++.h>
using namespace std;
const int N = 12;
const double eps = 1e-7;
double w[N][N], g[N][N]; 
int n;

void gauss() {
    for (int i = 1; i <= n; ++ i) {
        int row = i;
        for (int r = 1; r <= n; ++ r) {
            if (r < i && fabs(g[r][r]) >= eps) {
                continue;
            }
            if (fabs(g[r][i]) > fabs(g[row][i])) {
                row = r;
            }
        }

        swap(g[i], g[row]);

        if (fabs(g[i][i]) >= eps) {
            double tmp = g[i][i];
            for (int j = i; j <= n + 1; ++ j) {
                g[i][j] /= tmp;
            }
            for (int r = 1; r <= n; ++ r) {
                if (i != r) {
                    double rate = g[r][i] / g[i][i];
                    for (int k = i; k <= n + 1; ++ k) {
                        g[r][k] -= g[i][k] * rate;
                    }
                }
            }
        }
    }
}

int main() {
    scanf("%d", &n);
    for (int i = 1; i <= n + 1; ++ i)
        for (int j = 1; j <= n; ++ j)
            scanf("%lf", &w[i][j]);

    for (int i = 1; i <= n; ++ i) {
        for (int j = 1; j <= n; ++ j) {
            g[i][j] = 2 * (w[i][j] - w[i + 1][j]);
            g[i][n + 1] += w[i][j] * w[i][j] - w[i + 1][j] * w[i + 1][j];
        }
    }

    gauss();
    
    for (int i = 1; i <= n; ++ i) {
        printf("%.3lf ", g[i][n + 1]);
    }
}
```

# P5027 Barracuda
[传送门](https://www.luogu.com.cn/problem/P5027)
```C++
#include <bits/stdc++.h>
using namespace std;
const int N = 110;
const double eps = 1e-7;
int w[N][N], n, m, x;
double g[N][N];

void gauss() {
    for (int i = 1; i <= n; ++ i) {
        int row = i;
        for (int r = 1; r <= n; ++ r) {
            if (r < i && fabs(g[r][r]) >= eps) {
                continue;
            }
            if (fabs(g[r][i]) > fabs(g[row][i])) {
                row = r;
            }
        }
        
        swap(g[i], g[row]);
        
        if (fabs(g[i][i]) >= eps) {
            double tmp = g[i][i];
            for (int j = i; j <= n + 1; ++ j) {
                g[i][j] /= tmp;
            }
            for (int r = 1; r <= n; ++ r) {
                if (i != r) {
                    double rate = g[r][i] / g[i][i];
                    for (int k = i; k <= n + 1; ++ k) {
                        g[r][k] -= g[i][k] * rate;
                    }
                }
            }
        }
    }
}

void swapData(int a, int b) {
    for (int j = 1; j <= n + 1; ++ j) {
        swap(w[a][j], w[b][j]);
    }
}

int check() {
    gauss();
    double t = -1;
    int cnt = 0, id = 0;
    for (int i = 1; i <= n; ++ i) {
        if (g[i][i] == 0) {
            return 0;
        }
        // 判断是否为正整数
        if (g[i][n + 1] <= 0 || g[i][n + 1] != int(g[i][n + 1])) {
            return 0;
        }
        if (g[i][n + 1] > t) {
            t = g[i][n + 1];
            cnt = 1;
            id = i;
        } else if (g[i][n + 1] == t) {
            ++ cnt;
        }
    }
    if (cnt > 1) {
        return 0;
    }
    return id;
}

int main() {
    scanf("%d", &n);
    for (int i = 1; i <= n + 1; ++ i) {
        scanf("%d", &m);
        for (int j = 1; j <= m; ++ j) {
            scanf("%d", &x);
            w[i][x] = 1;
        }
        scanf("%d", &w[i][n + 1]);
    }

    int ans = 0, times = 0;
    for (int k = 1; k <= n + 1; ++ k) {
        swapData(k, n + 1);
        
        for (int i = 1; i <= n; ++ i) 
            for (int j = 1; j <= n + 1; ++ j) 
                g[i][j] = w[i][j];
        
        swapData(k, n + 1);
        
        int cur = check();
        if (cur != 0) {
            ++ times;
            ans = cur;
        }
    }

    if (times != 1) {
        puts("illegal");
    } else {
        printf("%d\n", ans);
    }

}
```
